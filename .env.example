# ==============================================
# Invoice Scanner - Environment Variables
# ==============================================
# Copy this file to .env.local and fill in your values
# After adding/changing .env.local, restart the dev server

# ==============================================
# OpenAI Configuration (Required)
# ==============================================
OPENAI_API_KEY=sk-...

# ==============================================
# Database Configuration (Required)
# ==============================================
# For PostgreSQL (Production - Recommended):
DATABASE_URL="postgresql://user:password@localhost:5432/invoice_scanner?schema=public"

# For SQLite (Development only):
# DATABASE_URL="file:./dev.db"

# Environment
NODE_ENV=development

# ==============================================
# NextAuth Configuration (Required)
# ==============================================
# Generate a secret key with: openssl rand -base64 32
AUTH_SECRET=your_auth_secret_here

# Base URL for OAuth callbacks
NEXTAUTH_URL=http://localhost:3000

# ==============================================
# Google OAuth (Optional - for Google sign-in)
# ==============================================
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your_google_client_id_here
GOOGLE_CLIENT_SECRET=your_google_client_secret_here

# ==============================================
# Email/SMTP Configuration (Optional)
# ==============================================
# For email verification and password reset
# If not configured, emails will be logged to console instead

# Gmail example (requires App Password):
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_app_password_here
SMTP_FROM_NAME="Invoice Scanner"
SMTP_FROM_EMAIL=your_email@gmail.com

# ==============================================
# AWS S3 Cloud Storage Configuration (Required for S3)
# ==============================================
# Region where your S3 bucket is located
AWS_REGION=us-east-1

# AWS IAM credentials (create dedicated IAM user for this app)
# Get these from AWS Console -> IAM -> Users -> Security credentials
AWS_ACCESS_KEY_ID=your_access_key_id_here
AWS_SECRET_ACCESS_KEY=your_secret_access_key_here

# S3 bucket name (must be globally unique)
# Create bucket in AWS Console -> S3 -> Create bucket
AWS_S3_BUCKET_NAME=invoice-scanner-files

# ==============================================
# S3 Settings (Optional - with sensible defaults)
# ==============================================
# Presigned URL expiration time in seconds (default: 3600 = 1 hour)
S3_PRESIGNED_URL_EXPIRY=3600

# Storage provider for new uploads: 'local' or 's3' (default: s3)
# Set to 'local' to use local filesystem, 's3' to use AWS S3
STORAGE_PROVIDER=s3

# ==============================================
# S3 Lifecycle Policies (Optional)
# ==============================================
# Note: These are configured in AWS S3 Console, not in .env
# Listed here for reference:
# - Archive to Glacier after 90 days
# - Delete after 365 days
# - Cleanup incomplete uploads after 7 days

# ==============================================
# How to Set Up AWS S3
# ==============================================
# 1. Create S3 Bucket:
#    - Go to AWS Console -> S3 -> Create bucket
#    - Name: invoice-scanner-files (or your choice)
#    - Region: us-east-1 (or your preferred region)
#    - Block all public access: ENABLED
#    - Versioning: Optional
#    - Server-side encryption: AES256 ENABLED
#
# 2. Create IAM User:
#    - Go to AWS Console -> IAM -> Users -> Create user
#    - User name: invoice-scanner-s3-user
#    - Access type: Programmatic access
#    - Attach policy (create custom policy):
#      {
#        "Version": "2012-10-17",
#        "Statement": [{
#          "Sid": "AllowS3InvoiceOperations",
#          "Effect": "Allow",
#          "Action": [
#            "s3:PutObject",
#            "s3:GetObject",
#            "s3:DeleteObject",
#            "s3:HeadObject",
#            "s3:ListBucket"
#          ],
#          "Resource": [
#            "arn:aws:s3:::invoice-scanner-files",
#            "arn:aws:s3:::invoice-scanner-files/*"
#          ]
#        }]
#      }
#    - Save Access Key ID and Secret Access Key
#
# 3. Configure Lifecycle Rules (Optional but recommended):
#    - Go to S3 bucket -> Management -> Lifecycle rules
#    - Create rule: Archive to Glacier after 90 days
#    - Create rule: Delete after 365 days
#    - Create rule: Cleanup incomplete uploads after 7 days

# ==============================================
# Migration Strategy
# ==============================================
# Fresh start approach (default):
# - Existing files stay in public/uploads/
# - New uploads go to S3 (if STORAGE_PROVIDER=s3)
# - System supports both transparently
# - Zero downtime migration

# ==============================================
# Cost Estimate
# ==============================================
# S3 Storage (us-east-1 pricing):
# - 100 invoices/month @ 500 KB = ~$0.02/month
# - 10,000 invoices/month = ~$20/month
# - Glacier archival (after 90 days): 75% cheaper than Standard

# ==============================================
# Troubleshooting
# ==============================================
# If uploads fail with S3 errors:
# 1. Verify AWS credentials are correct
# 2. Check IAM permissions (see policy above)
# 3. Verify S3 bucket name and region
# 4. Check bucket is created and accessible
# 5. Set STORAGE_PROVIDER=local to use local filesystem as fallback
# 6. Check server logs for detailed error messages
